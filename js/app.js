!function i(a,u,l){function s(t,e){if(!u[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var o=u[t]={exports:{}};a[t][0].call(o.exports,function(e){return s(a[t][1][e]||e)},o,o.exports,i,a,u,l)}return u[t].exports}for(var c="function"==typeof require&&require,e=0;e<l.length;e++)s(l[e]);return s}({1:[function(e,t,n){"use strict";var o=e("../render/vnode");t.exports=function(r){return function(e,t){if(null===t)return r.render(e,[]),void r.unsubscribe(e);if(null==t.view&&"function"!=typeof t)throw new Error("m.mount(element, component) expects a component, not a vnode");function n(){r.render(e,o(t))}r.subscribe(e,n),n()}}},{"../render/vnode":22}],2:[function(e,t,n){"use strict";var l=e("../render/render");t.exports=function(e,t){var n=l(e),r=[],o=!1;function i(e){var t=r.indexOf(e);-1<t&&r.splice(t,2)}function a(){if(o)throw new Error("Nested m.redraw.sync() call");o=!0;for(var e=1;e<r.length;e+=2)try{r[e]()}catch(e){"undefined"!=typeof console&&console.error(e)}o=!1}var u=(t||function(e){var t=null;return function(){null===t&&(t=requestAnimationFrame(function(){t=null,e()}))}})(a);return u.sync=a,n.setRedraw(u),{subscribe:function(e,t){i(e),r.push(e,t)},unsubscribe:i,redraw:u,render:n.render}}},{"../render/render":20}],3:[function(e,t,n){"use strict";var p=e("../render/vnode"),m=e("../promise/promise"),i=e("../router/router");t.exports=function(e,o){function r(e,t,n){if(null==e)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");function r(){null!=u&&o.render(e,u(p(l,s.key,s)))}var i=function(){r(),i=o.redraw};function a(e){if(e===t)throw new Error("Could not resolve default route "+t);d.setPath(t,null,{replace:!0})}o.subscribe(e,r),d.defineRoutes(n,function(t,n,r,e){var o=f=function(e,t){o===f&&(l=null==t||"function"!=typeof t.view&&"function"!=typeof t?"div":t,s=n,c=r,f=null,u=(e.render||function(e){return e}).bind(e),i())};t.view||"function"==typeof t?o({},t):t.onmatch?m.resolve(t.onmatch(n,r,e)).then(function(e){o(t,e)},function(){a(r)}):o(t,"div")},a,t)}var u,l,s,c,f,d=i(e);r.set=function(e,t,n){null!=f&&((n=n||{}).replace=!0),f=null,d.setPath(e,t,n)},r.get=function(){return c},r.prefix=function(e){d.prefix=e};function t(n,e){e.dom.setAttribute("href",d.prefix+e.attrs.href),e.dom.onclick=function(e){if(!(e.ctrlKey||e.metaKey||e.shiftKey||2===e.which)){e.preventDefault(),e.redraw=!1;var t=this.getAttribute("href");0===t.indexOf(d.prefix)&&(t=t.slice(d.prefix.length)),r.set(t,void 0,n)}}}return r.link=function(e){return null==e.tag?t.bind(t,e):t({},e)},r.param=function(e){return void 0!==s&&void 0!==e?s[e]:s},r}},{"../promise/promise":12,"../render/vnode":22,"../router/router":26}],4:[function(e,t,n){"use strict";var r=e("./render/hyperscript");r.trust=e("./render/trust"),r.fragment=e("./render/fragment"),t.exports=r},{"./render/fragment":17,"./render/hyperscript":18,"./render/trust":21}],5:[function(e,t,n){"use strict";function r(){return o.apply(this,arguments)}var o=e("./hyperscript");r.m=o,r.trust=o.trust,r.fragment=o.fragment;var i=e("./request"),a=e("./redraw");i.setCompletionCallback(a.redraw),r.mount=e("./mount"),r.route=e("./route"),r.render=e("./render").render,r.redraw=a.redraw,r.request=i.request,r.jsonp=i.jsonp,r.parseQueryString=e("./querystring/parse"),r.buildQueryString=e("./querystring/build"),r.parsePathname=e("./pathname/parse"),r.buildPathname=e("./pathname/build"),r.version="bleeding-edge",r.vnode=e("./render/vnode"),r.PromisePolyfill=e("./promise/polyfill"),t.exports=r},{"./hyperscript":4,"./mount":6,"./pathname/build":8,"./pathname/parse":10,"./promise/polyfill":11,"./querystring/build":13,"./querystring/parse":14,"./redraw":15,"./render":16,"./render/vnode":22,"./request":23,"./route":25}],6:[function(e,t,n){"use strict";var r=e("./redraw");t.exports=e("./api/mount")(r)},{"./api/mount":1,"./redraw":15}],7:[function(e,t,n){"use strict";t.exports=Object.assign||function(t,n){Object.keys(n).forEach(function(e){t[e]=n[e]})}},{}],8:[function(e,t,n){"use strict";var v=e("../querystring/build"),h=e("./assign");t.exports=function(e,r){if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Template parameter names *must* be separated");if(null==r)return e;var t=e.indexOf("?"),n=e.indexOf("#"),o=n<0?e.length:n,i=t<0?o:t,a=e.slice(0,i),u={};h(u,r);var l=a.replace(/:([^\/\.-]+)(\.{3})?/g,function(e,t,n){return delete u[t],null==r[t]?e:n?r[t]:encodeURIComponent(String(r[t]))}),s=l.indexOf("?"),c=l.indexOf("#"),f=c<0?l.length:c,d=s<0?f:s,p=l.slice(0,d);0<=t&&(p+="?"+e.slice(t,o)),0<=s&&(p+=(t<0?"?":"&")+l.slice(s,f));var m=v(u);return m&&(p+=(t<0&&s<0?"?":"&")+m),0<=n&&(p+=e.slice(n)),0<=c&&(p+=(n<0?"":"&")+l.slice(c)),p}},{"../querystring/build":13,"./assign":7}],9:[function(e,t,n){"use strict";var u=e("./parse");t.exports=function(e){var r=u(e),o=Object.keys(r.params),i=[],a=new RegExp("^"+r.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,function(e,t,n){return null==t?"\\"+e:(i.push({k:t,r:"..."===n}),"..."===n?"(.*)":"."===n?"([^/]+)\\.":"([^/]+)"+(n||""))})+"$");return function(e){for(var t=0;t<o.length;t++)if(r.params[o[t]]!==e.params[o[t]])return!1;if(!i.length)return a.test(e.path);var n=a.exec(e.path);if(null==n)return!1;for(t=0;t<i.length;t++)e.params[i[t].k]=i[t].r?n[t+1]:decodeURIComponent(n[t+1]);return!0}}},{"./parse":10}],10:[function(e,t,n){"use strict";var u=e("../querystring/parse");t.exports=function(e){var t=e.indexOf("?"),n=e.indexOf("#"),r=n<0?e.length:n,o=t<0?r:t,i=e.slice(0,o).replace(/\/{2,}/g,"/"),a={};return i?("/"!==i[0]&&(i="/"+i),1<i.length&&"/"===i[i.length-1]&&(i=i.slice(0,-1))):i="/",0<=t&&u(e.slice(t+1,r),a),0<=n&&u(e.slice(n+1),a),{path:i,params:a}}},{"../querystring/parse":14}],11:[function(e,t,n){(function(n){"use strict";var d=function(e){if(!(this instanceof d))throw new Error("Promise must be called with `new`");if("function"!=typeof e)throw new TypeError("executor must be a function");var i=this,a=[],u=[],o=t(a,!0),l=t(u,!1),s=i._instance={resolvers:a,rejectors:u},c="function"==typeof n?n:setTimeout;function t(r,o){return function t(n){var e;try{if(!o||null==n||"object"!=typeof n&&"function"!=typeof n||"function"!=typeof(e=n.then))c(function(){o||0!==r.length||console.error("Possible unhandled promise rejection:",n);for(var e=0;e<r.length;e++)r[e](n);a.length=0,u.length=0,s.state=o,s.retry=function(){t(n)}});else{if(n===i)throw new TypeError("Promise can't be resolved w/ itself");f(e.bind(n))}}catch(e){l(e)}}}function f(e){var n=0;function t(t){return function(e){0<n++||t(e)}}var r=t(l);try{e(t(o),r)}catch(e){r(e)}}f(e)};d.prototype.then=function(e,t){var o,i,a=this._instance;function n(t,e,n,r){e.push(function(e){if("function"!=typeof t)n(e);else try{o(t(e))}catch(e){i&&i(e)}}),"function"==typeof a.retry&&r===a.state&&a.retry()}var r=new d(function(e,t){o=e,i=t});return n(e,a.resolvers,o,!0),n(t,a.rejectors,i,!1),r},d.prototype.catch=function(e){return this.then(null,e)},d.prototype.finally=function(t){return this.then(function(e){return d.resolve(t()).then(function(){return e})},function(e){return d.resolve(t()).then(function(){return d.reject(e)})})},d.resolve=function(t){return t instanceof d?t:new d(function(e){e(t)})},d.reject=function(n){return new d(function(e,t){t(n)})},d.all=function(u){return new d(function(n,r){var o=u.length,i=0,a=[];if(0===u.length)n([]);else for(var e=0;e<u.length;e++)!function(t){function e(e){i++,a[t]=e,i===o&&n(a)}null==u[t]||"object"!=typeof u[t]&&"function"!=typeof u[t]||"function"!=typeof u[t].then?e(u[t]):u[t].then(e,r)}(e)})},d.race=function(r){return new d(function(e,t){for(var n=0;n<r.length;n++)r[n].then(e,t)})},t.exports=d}).call(this,e("timers").setImmediate)},{timers:30}],12:[function(n,r,e){(function(e){"use strict";var t=n("./polyfill");"undefined"!=typeof window?(void 0===window.Promise?window.Promise=t:window.Promise.prototype.finally||(window.Promise.prototype.finally=t.prototype.finally),r.exports=window.Promise):void 0!==e?(void 0===e.Promise?e.Promise=t:e.Promise.prototype.finally||(e.Promise.prototype.finally=t.prototype.finally),r.exports=e.Promise):r.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polyfill":11}],13:[function(e,t,n){"use strict";t.exports=function(e){if("[object Object]"!==Object.prototype.toString.call(e))return"";var r=[];for(var t in e)o(t,e[t]);return r.join("&");function o(e,t){if(Array.isArray(t))for(var n=0;n<t.length;n++)o(e+"["+n+"]",t[n]);else if("[object Object]"===Object.prototype.toString.call(t))for(var n in t)o(e+"["+n+"]",t[n]);else r.push(encodeURIComponent(e)+(null!=t&&""!==t?"="+encodeURIComponent(t):""))}}},{}],14:[function(e,t,n){"use strict";t.exports=function(e,t){if(null==t&&(t={}),""===e||null==e)return{};"?"===e.charAt(0)&&(e=e.slice(1));for(var n=e.split("&"),r={},o=0;o<n.length;o++){var i=n[o].split("="),a=decodeURIComponent(i[0]),u=2===i.length?decodeURIComponent(i[1]):"";"true"===u?u=!0:"false"===u&&(u=!1);var l=a.split(/\]\[?|\[/),s=t;-1<a.indexOf("[")&&l.pop();for(var c=0;c<l.length;c++){var f=l[c],d=l[c+1],p=""==d||!isNaN(parseInt(d,10)),m=c===l.length-1;if(""===f)null==r[a=l.slice(0,c).join()]&&(r[a]=Array.isArray(s)?s.length:0),f=r[a]++;m?s[f]=u:null==s[f]&&(s[f]=p?[]:{}),s=s[f]}}return t}},{}],15:[function(e,t,n){"use strict";t.exports=e("./api/redraw")(window)},{"./api/redraw":2}],16:[function(e,t,n){"use strict";t.exports=e("./render/render")(window)},{"./render/render":20}],17:[function(e,t,n){"use strict";var r=e("../render/vnode"),o=e("./hyperscriptVnode");t.exports=function(){var e=o.apply(0,arguments);return e.tag="[",e.children=r.normalizeChildren(e.children),e}},{"../render/vnode":22,"./hyperscriptVnode":19}],18:[function(e,t,n){"use strict";var l=e("../render/vnode"),r=e("./hyperscriptVnode"),s=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,c={},f={}.hasOwnProperty;function d(e){for(var t in e)if(f.call(e,t))return!1;return!0}t.exports=function(e){if(null==e||"string"!=typeof e&&"function"!=typeof e&&"function"!=typeof e.view)throw Error("The selector must be either a string or a component.");var t=r.apply(1,arguments);return"string"==typeof e&&(t.children=l.normalizeChildren(t.children),"["!==e)?function(e,t){var n=t.attrs,r=l.normalizeChildren(t.children),o=f.call(n,"class"),i=o?n.class:n.className;if(t.tag=e.tag,t.attrs=null,t.children=void 0,!d(e.attrs)&&!d(n)){var a={};for(var u in n)f.call(n,u)&&(a[u]=n[u]);n=a}for(var u in e.attrs)f.call(e.attrs,u)&&"className"!==u&&!f.call(n,u)&&(n[u]=e.attrs[u]);for(var u in null==i&&null==e.attrs.className||(n.className=null!=i?null!=e.attrs.className?String(e.attrs.className)+" "+String(i):i:null!=e.attrs.className?e.attrs.className:null),o&&(n.class=null),n)if(f.call(n,u)&&"key"!==u){t.attrs=n;break}return Array.isArray(r)&&1===r.length&&null!=r[0]&&"#"===r[0].tag?t.text=r[0].children:t.children=r,t}(c[e]||function(e){for(var t,n="div",r=[],o={};t=s.exec(e);){var i=t[1],a=t[2];if(""===i&&""!==a)n=a;else if("#"===i)o.id=a;else if("."===i)r.push(a);else if("["===t[3][0]){var u=t[6];u=u&&u.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\"),"class"===t[4]?r.push(u):o[t[4]]=""===u?u:u||!0}}return 0<r.length&&(o.className=r.join(" ")),c[e]={tag:n,attrs:o}}(e),t):(t.tag=e,t)}},{"../render/vnode":22,"./hyperscriptVnode":19}],19:[function(e,t,n){"use strict";var r=e("../render/vnode");t.exports=function(){var e,t=arguments[this],n=this+1;if(null==t?t={}:"object"==typeof t&&null==t.tag&&!Array.isArray(t)||(t={},n=this),arguments.length===n+1)e=arguments[n],Array.isArray(e)||(e=[e]);else for(e=[];n<arguments.length;)e.push(arguments[n++]);return r("",t.key,t,e)}},{"../render/vnode":22}],20:[function(e,t,n){"use strict";var T=e("../render/vnode");t.exports=function(e){var r,c=e.document,t={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function f(e){return e.attrs&&e.attrs.xmlns||t[e.tag]}function a(e,t){if(e.state!==t)throw new Error("`vnode.state` must not be modified")}function u(e){var t=e.state;try{return this.apply(t,arguments)}finally{a(e,t)}}function l(){try{return c.activeElement}catch(e){return null}}function E(e,t,n,r,o,i,a){for(var u=n;u<r;u++){var l=t[u];null!=l&&O(e,l,o,a,i)}}function O(e,t,n,r,o){var i=t.tag;if("string"==typeof i)switch(t.state={},null!=t.attrs&&_(t.attrs,t,n),i){case"#":!function(e,t,n){t.dom=c.createTextNode(t.children),j(e,t.dom,n)}(e,t,o);break;case"<":d(e,t,r,o);break;case"[":!function(e,t,n,r,o){var i=c.createDocumentFragment();if(null!=t.children){var a=t.children;E(i,a,0,a.length,n,null,r)}t.dom=i.firstChild,t.domSize=i.childNodes.length,j(e,i,o)}(e,t,n,r,o);break;default:!function(e,t,n,r,o){var i=t.tag,a=t.attrs,u=a&&a.is,l=(r=f(t)||r)?u?c.createElementNS(r,i,{is:u}):c.createElementNS(r,i):u?c.createElement(i,{is:u}):c.createElement(i);t.dom=l,null!=a&&function(e,t,n){for(var r in t)v(e,r,null,t[r],n)}(t,a,r);if(j(e,l,o),null!=a&&null!=a.contenteditable)m(t);else if(null!=t.text&&(""!==t.text?l.textContent=t.text:t.children=[T("#",void 0,void 0,t.text,void 0,void 0)]),null!=t.children){var s=t.children;E(l,s,0,s.length,n,null,r),"select"===t.tag&&null!=a&&function(e,t){if("value"in t)if(null===t.value)-1!==e.dom.selectedIndex&&(e.dom.value=null);else{var n=""+t.value;e.dom.value===n&&-1!==e.dom.selectedIndex||(e.dom.value=n)}"selectedIndex"in t&&v(e,"selectedIndex",null,t.selectedIndex,void 0)}(t,a)}}(e,t,n,r,o)}else!function(e,t,n,r,o){(function(e,t){var n;if("function"==typeof e.tag.view){if(e.state=Object.create(e.tag),null!=(n=e.state.view).$$reentrantLock$$)return;n.$$reentrantLock$$=!0}else{if(e.state=void 0,null!=(n=e.tag).$$reentrantLock$$)return;n.$$reentrantLock$$=!0,e.state=null!=e.tag.prototype&&"function"==typeof e.tag.prototype.view?new e.tag(e):e.tag(e)}_(e.state,e,t),null!=e.attrs&&_(e.attrs,e,t);if(e.instance=T.normalize(u.call(e.state.view,e)),e.instance===e)throw Error("A view cannot return the vnode it received as argument");n.$$reentrantLock$$=null})(t,n),null!=t.instance?(O(e,t.instance,n,r,o),t.dom=t.instance.dom,t.domSize=null!=t.dom?t.instance.domSize:0):t.domSize=0}(e,t,n,r,o)}var s={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function d(e,t,n,r){var o=t.children.match(/^\s*?<(\w+)/im)||[],i=c.createElement(s[o[1]]||"div");"http://www.w3.org/2000/svg"===n?(i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t.children+"</svg>",i=i.firstChild):i.innerHTML=t.children,t.dom=i.firstChild,t.domSize=i.childNodes.length;for(var a,u=c.createDocumentFragment();a=i.firstChild;)u.appendChild(a);j(e,u,r)}function p(e,t,n,r,o,i){if(t!==n&&(null!=t||null!=n))if(null==t||0===t.length)E(e,n,0,n.length,r,o,i);else if(null==n||0===n.length)L(t,0,t.length);else{for(var a=0,u=0,l=null,s=null;u<t.length;u++)if(null!=t[u]){l=null!=t[u].key;break}for(;a<n.length;a++)if(null!=n[a]){s=null!=n[a].key;break}if(null===s&&null==l)return;if(l!==s)L(t,u,t.length),E(e,n,a,n.length,r,o,i);else if(s){for(var c,f,d,p,m,v=t.length-1,h=n.length-1;u<=v&&a<=h;)if(d=t[v],p=n[h],null==d)v--;else if(null==p)h--;else{if(d.key!==p.key)break;d!==p&&M(e,d,p,r,o,i),null!=p.dom&&(o=p.dom),v--,h--}for(;u<=v&&a<=h;)if(c=t[u],f=n[a],null==c)u++;else if(null==f)a++;else{if(c.key!==f.key)break;u++,a++,c!==f&&M(e,c,f,r,N(t,u,o),i)}for(;u<=v&&a<=h;){if(null==c)u++;else if(null==f)a++;else if(null==d)v--;else if(null==p)h--;else{if(a===h)break;if(c.key!==p.key||d.key!==f.key)break;m=N(t,u,o),j(e,A(d),m),d!==f&&M(e,d,f,r,m,i),++a<=--h&&j(e,A(c),o),c!==p&&M(e,c,p,r,o,i),null!=p.dom&&(o=p.dom),u++,v--}d=t[v],p=n[h],c=t[u],f=n[a]}for(;u<=v&&a<=h;){if(null==d)v--;else if(null==p)h--;else{if(d.key!==p.key)break;d!==p&&M(e,d,p,r,o,i),null!=p.dom&&(o=p.dom),v--,h--}d=t[v],p=n[h]}if(h<a)L(t,u,v+1);else if(v<u)E(e,n,a,h+1,r,o,i);else{var y,g,b=o,w=h-a+1,x=new Array(w),_=0,k=0,T=2147483647,I=0;for(k=0;k<w;k++)x[k]=-1;for(k=h;a<=k;k--)if(null==y&&(y=C(t,u,v+1)),null!=(p=n[k])){var S=y[p.key];null!=S&&(T=S<T?S:-1,d=t[x[k-a]=S],t[S]=null,d!==p&&M(e,d,p,r,o,i),null!=p.dom&&(o=p.dom),I++)}if(o=b,I!==v-u+1&&L(t,u,v+1),0===I)E(e,n,a,h+1,r,o,i);else if(-1===T)for(_=(g=function(e){var t,n,r=e.slice(),o=[];o.push(0);for(var i=0,a=e.length;i<a;++i)if(-1!==e[i]){var u=o[o.length-1];if(e[u]<e[i])r[i]=u,o.push(i);else{for(t=0,n=o.length-1;t<n;){var l=(t+n)/2|0;e[o[l]]<e[i]?t=1+l:n=l}e[i]<e[o[t]]&&(0<t&&(r[i]=o[t-1]),o[t]=i)}}t=o.length,n=o[t-1];for(;0<t--;)o[t]=n,n=r[n];return o}(x)).length-1,k=h;a<=k;k--)f=n[k],-1===x[k-a]?O(e,f,r,i,o):g[_]===k-a?_--:j(e,A(f),o),null!=f.dom&&(o=n[k].dom);else for(k=h;a<=k;k--)f=n[k],-1===x[k-a]&&O(e,f,r,i,o),null!=f.dom&&(o=n[k].dom)}}else{var P=t.length<n.length?t.length:n.length;for(a=a<u?a:u;a<P;a++)(c=t[a])===(f=n[a])||null==c&&null==f||(null==c?O(e,f,r,i,N(t,a+1,o)):null==f?D(c):M(e,c,f,r,N(t,a+1,o),i));t.length>P&&L(t,a,t.length),n.length>P&&E(e,n,a,n.length,r,o,i)}}}function M(e,t,n,r,o,i){var a=t.tag;if(a===n.tag){if(n.state=t.state,n.events=t.events,function(e,t){do{var n;if(null!=e.attrs&&"function"==typeof e.attrs.onbeforeupdate)if(void 0!==(n=u.call(e.attrs.onbeforeupdate,e,t))&&!n)break;if("string"!=typeof e.tag&&"function"==typeof e.state.onbeforeupdate)if(void 0!==(n=u.call(e.state.onbeforeupdate,e,t))&&!n)break;return!1}while(0);return e.dom=t.dom,e.domSize=t.domSize,e.instance=t.instance,!0}(n,t))return;if("string"==typeof a)switch(null!=n.attrs&&k(n.attrs,n,r),a){case"#":!function(e,t){e.children.toString()!==t.children.toString()&&(e.dom.nodeValue=t.children);t.dom=e.dom}(t,n);break;case"<":!function(e,t,n,r,o){t.children!==n.children?(A(t),d(e,n,r,o)):(n.dom=t.dom,n.domSize=t.domSize)}(e,t,n,i,o);break;case"[":!function(e,t,n,r,o,i){p(e,t.children,n.children,r,o,i);var a=0,u=n.children;if((n.dom=null)!=u){for(var l=0;l<u.length;l++){var s=u[l];null!=s&&null!=s.dom&&(null==n.dom&&(n.dom=s.dom),a+=s.domSize||1)}1!==a&&(n.domSize=a)}}(e,t,n,r,o,i);break;default:!function(e,t,n,r){var o=t.dom=e.dom;r=f(t)||r,"textarea"===t.tag&&(null==t.attrs&&(t.attrs={}),null!=t.text&&(t.attrs.value=t.text,t.text=void 0));(function(e,t,n,r){if(null!=n)for(var o in n)v(e,o,t&&t[o],n[o],r);var i;if(null!=t)for(var o in t)null==(i=t[o])||null!=n&&null!=n[o]||h(e,o,i,r)})(t,e.attrs,t.attrs,r),null!=t.attrs&&null!=t.attrs.contenteditable?m(t):null!=e.text&&null!=t.text&&""!==t.text?e.text.toString()!==t.text.toString()&&(e.dom.firstChild.nodeValue=t.text):(null!=e.text&&(e.children=[T("#",void 0,void 0,e.text,void 0,e.dom.firstChild)]),null!=t.text&&(t.children=[T("#",void 0,void 0,t.text,void 0,void 0)]),p(o,e.children,t.children,n,null,r))}(t,n,r,i)}else!function(e,t,n,r,o,i){if(n.instance=T.normalize(u.call(n.state.view,n)),n.instance===n)throw Error("A view cannot return the vnode it received as argument");k(n.state,n,r),null!=n.attrs&&k(n.attrs,n,r);null!=n.instance?(null==t.instance?O(e,n.instance,r,i,o):M(e,t.instance,n.instance,r,o,i),n.dom=n.instance.dom,n.domSize=n.instance.domSize):null!=t.instance?(D(t.instance),n.dom=void 0,n.domSize=0):(n.dom=t.dom,n.domSize=t.domSize)}(e,t,n,r,o,i)}else D(t),O(e,n,r,i,o)}function C(e,t,n){for(var r=Object.create(null);t<n;t++){var o=e[t];if(null!=o){var i=o.key;null!=i&&(r[i]=t)}}return r}function A(e){var t=e.domSize;if(null==t&&null!=e.dom)return e.dom;var n=c.createDocumentFragment();if(0<t){for(var r=e.dom;--t;)n.appendChild(r.nextSibling);n.insertBefore(r,n.firstChild)}return n}function N(e,t,n){for(;t<e.length;t++)if(null!=e[t]&&null!=e[t].dom)return e[t].dom;return n}function j(e,t,n){null!=n?e.insertBefore(t,n):e.appendChild(t)}function m(e){var t=e.children;if(null!=t&&1===t.length&&"<"===t[0].tag){var n=t[0].children;e.dom.innerHTML!==n&&(e.dom.innerHTML=n)}else if(null!=e.text||null!=t&&0!==t.length)throw new Error("Child node of a contenteditable must be trusted")}function L(e,t,n){for(var r=t;r<n;r++){var o=e[r];null!=o&&D(o)}}function D(n){var e,r=1,o=0,i=n.state;"string"!=typeof n.tag&&"function"==typeof n.state.onbeforeremove&&null!=(e=u.call(n.state.onbeforeremove,n))&&"function"==typeof e.then&&(r++,e.then(t,t));n.attrs&&"function"==typeof n.attrs.onbeforeremove&&null!=(e=u.call(n.attrs.onbeforeremove,n))&&"function"==typeof e.then&&(r++,e.then(t,t));function t(){if(++o===r&&(a(n,i),function e(t){"string"!=typeof t.tag&&"function"==typeof t.state.onremove&&u.call(t.state.onremove,t);t.attrs&&"function"==typeof t.attrs.onremove&&u.call(t.attrs.onremove,t);if("string"!=typeof t.tag)null!=t.instance&&e(t.instance);else{var n=t.children;if(Array.isArray(n))for(var r=0;r<n.length;r++){var o=n[r];null!=o&&e(o)}}}(n),n.dom)){for(var e=n.dom.parentNode,t=n.domSize||1;--t;)e.removeChild(n.dom.nextSibling);e.removeChild(n.dom)}}t()}function v(e,t,n,r,o){if("key"!==t&&"is"!==t&&null!=r&&!i(t)&&(n!==r||function(e,t){return"value"===t||"checked"===t||"selectedIndex"===t||"selected"===t&&e.dom===l()||"option"===e.tag&&e.dom.parentNode===c.activeElement}(e,t)||"object"==typeof r)){if("o"===t[0]&&"n"===t[1])return x(e,t,r);if("xlink:"===t.slice(0,6))e.dom.setAttributeNS("http://www.w3.org/1999/xlink",t.slice(6),r);else if("style"===t)b(e.dom,n,r);else if(y(e,t,o)){if("value"===t){if(("input"===e.tag||"textarea"===e.tag)&&e.dom.value===""+r&&e.dom===l())return;if("select"===e.tag&&null!==n&&e.dom.value===""+r)return;if("option"===e.tag&&null!==n&&e.dom.value===""+r)return}"input"===e.tag&&"type"===t?e.dom.setAttribute(t,r):e.dom[t]=r}else"boolean"==typeof r?r?e.dom.setAttribute(t,""):e.dom.removeAttribute(t):e.dom.setAttribute("className"===t?"class":t,r)}}function h(e,t,n,r){if("key"!==t&&"is"!==t&&null!=n&&!i(t))if("o"!==t[0]||"n"!==t[1]||i(t))if("style"===t)b(e.dom,n,null);else if(!y(e,t,r)||"className"===t||"value"===t&&("option"===e.tag||"select"===e.tag&&-1===e.dom.selectedIndex&&e.dom===l())||"input"===e.tag&&"type"===t){var o=t.indexOf(":");-1!==o&&(t=t.slice(o+1)),!1!==n&&e.dom.removeAttribute("className"===t?"class":t)}else e.dom[t]=null;else x(e,t,void 0)}function i(e){return"oninit"===e||"oncreate"===e||"onupdate"===e||"onremove"===e||"onbeforeremove"===e||"onbeforeupdate"===e}function y(e,t,n){return void 0===n&&(-1<e.tag.indexOf("-")||null!=e.attrs&&e.attrs.is||"href"!==t&&"list"!==t&&"form"!==t&&"width"!==t&&"height"!==t)&&t in e.dom}var n=/[A-Z]/g;function o(e){return"-"+e.toLowerCase()}function g(e){return"-"===e[0]&&"-"===e[1]?e:"cssFloat"===e?"float":e.replace(n,o)}function b(e,t,n){if(t===n);else if(null==n)e.style.cssText="";else if("object"!=typeof n)e.style.cssText=n;else if(null==t||"object"!=typeof t)for(var r in e.style.cssText="",n){null!=(o=n[r])&&e.style.setProperty(g(r),String(o))}else{for(var r in n){var o;null!=(o=n[r])&&(o=String(o))!==String(t[r])&&e.style.setProperty(g(r),o)}for(var r in t)null!=t[r]&&null==n[r]&&e.style.removeProperty(g(r))}}function w(){}function x(e,t,n){if(null!=e.events){if(e.events[t]===n)return;null==n||"function"!=typeof n&&"object"!=typeof n?(null!=e.events[t]&&e.dom.removeEventListener(t.slice(2),e.events,!1),e.events[t]=void 0):(null==e.events[t]&&e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=n)}else null==n||"function"!=typeof n&&"object"!=typeof n||(e.events=new w,e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=n)}function _(e,t,n){"function"==typeof e.oninit&&u.call(e.oninit,t),"function"==typeof e.oncreate&&n.push(u.bind(e.oncreate,t))}function k(e,t,n){"function"==typeof e.onupdate&&n.push(u.bind(e.onupdate,t))}return(w.prototype=Object.create(null)).handleEvent=function(e){var t,n=this["on"+e.type];"function"==typeof n?t=n.call(e.currentTarget,e):"function"==typeof n.handleEvent&&n.handleEvent(e),!1===e.redraw?e.redraw=void 0:"function"==typeof r&&r(),!1===t&&(e.preventDefault(),e.stopPropagation())},{render:function(e,t){if(!e)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var n=[],r=l(),o=e.namespaceURI;null==e.vnodes&&(e.textContent=""),t=T.normalizeChildren(Array.isArray(t)?t:[t]),p(e,e.vnodes,t,n,null,"http://www.w3.org/1999/xhtml"===o?void 0:o),e.vnodes=t,null!=r&&l()!==r&&"function"==typeof r.focus&&r.focus();for(var i=0;i<n.length;i++)n[i]()},setRedraw:function(e){return r=e}}}},{"../render/vnode":22}],21:[function(e,t,n){"use strict";var r=e("../render/vnode");t.exports=function(e){return null==e&&(e=""),r("<",void 0,void 0,e,void 0,void 0)}},{"../render/vnode":22}],22:[function(e,t,n){"use strict";function r(e,t,n,r,o,i){return{tag:e,key:t,attrs:n,children:r,text:o,dom:i,domSize:void 0,state:void 0,events:void 0,instance:void 0}}r.normalize=function(e){return Array.isArray(e)?r("[",void 0,void 0,r.normalizeChildren(e),void 0,void 0):null!=e&&"object"!=typeof e?r("#",void 0,void 0,!1===e?"":e,void 0,void 0):e},r.normalizeChildren=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=r.normalize(e[n]);return t},t.exports=r},{}],23:[function(e,t,n){"use strict";var r=e("./promise/promise");t.exports=e("./request/request")(window,r)},{"./promise/promise":12,"./request/request":24}],24:[function(e,t,n){"use strict";var l=e("../pathname/build");t.exports=function(f,n){var u,a=0;function e(a){return function(t,r){"string"!=typeof t?t=(r=t).url:null==r&&(r={});var e=new n(function(n,e){a(l(t,r.params),r,function(e){if("function"==typeof r.type)if(Array.isArray(e))for(var t=0;t<e.length;t++)e[t]=new r.type(e[t]);else e=new r.type(e);n(e)},e)});if(!0===r.background)return e;var o=0;function i(){0==--o&&"function"==typeof u&&u()}return function t(n){var r=n.then;n.then=function(){o++;var e=r.apply(n,arguments);return e.then(i,function(e){if(i(),0===o)throw e}),t(e)};return n}(e)}}function d(e,t){for(var n in e.headers)if({}.hasOwnProperty.call(e.headers,n)&&t.test(n))return!0;return!1}return{request:e(function(o,i,a,u){var e=null!=i.method?i.method.toUpperCase():"GET",t=i.body,n=!(null!=i.serialize&&i.serialize!==JSON.serialize||t instanceof f.FormData),l=new f.XMLHttpRequest,s=!1,r=l.abort;for(var c in l.abort=function(){s=!0,r.call(l)},l.open(e,o,!1!==i.async,"string"==typeof i.user?i.user:void 0,"string"==typeof i.password?i.password:void 0),n&&null!=t&&!d(i,/^content-type$/i)&&l.setRequestHeader("Content-Type","application/json; charset=utf-8"),"function"==typeof i.deserialize||d(i,/^accept$/i)||l.setRequestHeader("Accept","application/json, text/*"),i.withCredentials&&(l.withCredentials=i.withCredentials),i.timeout&&(l.timeout=i.timeout),l.responseType=i.responseType||("function"==typeof i.extract?"":"json"),i.headers)!{}.hasOwnProperty.call(i.headers,c)||l.setRequestHeader(c,i.headers[c]);"function"==typeof i.config&&(l=i.config(l,i)||l),l.onreadystatechange=function(){if(!s&&4===l.readyState)try{var t,e=200<=l.status&&l.status<300||304===l.status||/^file:\/\//i.test(o),n=l.response;if(null==n)try{n=l.responseText,"function"!=typeof i.extract&&"json"===l.responseType&&(n=JSON.parse(n))}catch(e){n=null}if("function"==typeof i.extract?(n=i.extract(l,i),e=!0):"function"==typeof i.deserialize&&(n=i.deserialize(n)),e)a(n);else{try{t=l.responseText}catch(e){t=n}var r=new Error(t);r.code=l.status,r.response=n,u(r)}}catch(e){u(e)}},null==t?l.send():"function"==typeof i.serialize?l.send(i.serialize(t)):t instanceof f.FormData?l.send(t):l.send(JSON.stringify(t))}),jsonp:e(function(e,t,n,r){var o=t.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+a++,i=f.document.createElement("script");f[o]=function(e){delete f[o],i.parentNode.removeChild(i),n(e)},i.onerror=function(){delete f[o],i.parentNode.removeChild(i),r(new Error("JSONP request failed"))},i.src=e+(e.indexOf("?")<0?"?":"&")+encodeURIComponent(t.callbackKey||"callback")+"="+encodeURIComponent(o),f.document.documentElement.appendChild(i)}),setCompletionCallback:function(e){u=e}}}},{"../pathname/build":8}],25:[function(e,t,n){"use strict";var r=e("./redraw");t.exports=e("./api/router")(window,r)},{"./api/router":3,"./redraw":15}],26:[function(e,n,t){(function(t){"use strict";var i=e("../pathname/build"),d=e("../pathname/parse"),p=e("../pathname/compileTemplate"),m=e("../pathname/assign");n.exports=function(u){var l,s="function"==typeof u.history.pushState,c="function"==typeof t?t:setTimeout;function e(e){var t=u.location[e].replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent);return"pathname"===e&&"/"!==t[0]&&(t="/"+t),t}var f={prefix:"#!",getPath:function(){return"#"===f.prefix.charAt(0)?e("hash").slice(f.prefix.length):"?"===f.prefix.charAt(0)?e("search").slice(f.prefix.length)+e("hash"):e("pathname").slice(f.prefix.length)+e("search")+e("hash")},setPath:function(e,t,n){if(e=i(e,t),s){var r=n?n.state:null,o=n?n.title:null;u.onpopstate(),n&&n.replace?u.history.replaceState(r,o,f.prefix+e):u.history.pushState(r,o,f.prefix+e)}else u.location.href=f.prefix+e},defineRoutes:function(t,r,o,e){var i=Object.keys(t).map(function(e){if("/"!==e.charAt(0))throw new SyntaxError("Routes must start with a `/`");if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Route parameter names must be separated with either `/`, `.`, or `-`");return{route:e,component:t[e],check:p(e)}});if(null!=e){var n=d(e);if(!i.some(function(e){return e.check(n)}))throw new ReferenceError("Default route doesn't match any known routes")}function a(){var e=f.getPath(),t=d(e);m(t.params,u.history.state);for(var n=0;n<i.length;n++)if(i[n].check(t))return void r(i[n].component,t.params,e,i[n].route);o(e,t.params)}s?u.onpopstate=function(){l=l||c(function(){l=null,a()})}:"#"===f.prefix.charAt(0)&&(u.onhashchange=a),a()}};return f}}).call(this,e("timers").setImmediate)},{"../pathname/assign":7,"../pathname/build":8,"../pathname/compileTemplate":9,"../pathname/parse":10,timers:30}],27:[function(e,t,n){"use strict";t.exports=e("./stream/stream")},{"./stream/stream":28}],28:[function(e,o,t){!function(){"use strict";l.SKIP={},l.lift=function(){var t=arguments[0];return r(Array.prototype.slice.call(arguments,1)).map(function(e){return t.apply(void 0,e)})},l.scan=function(n,r,e){var t=e.map(function(e){var t=n(r,e);return t!==l.SKIP&&(r=t),t});return t(r),t},l.merge=r,l.combine=n,l.scanMerge=function(r,o){var e=r.map(function(e){return e[0]}),t=n(function(){var n=arguments[arguments.length-1];return e.forEach(function(e,t){-1<n.indexOf(e)&&(o=r[t][1](o,e()))}),o},e);return t(o),t},l["fantasy-land/of"]=l;var e=!1;function l(r){var e,o=[],i=[];function a(e){return arguments.length&&e!==l.SKIP&&(r=e,t(a)&&(a.changing(),a.state="active",o.forEach(function(e,t){e(i[t](r))}))),r}return a.constructor=l,a.state=arguments.length&&r!==l.SKIP?"active":"pending",a.parents=[],a.changing=function(){t(a)&&(a.state="changing"),o.forEach(function(e){e.changing()})},a.map=function(e,t){var n="active"===a.state&&t!==l.SKIP?l(e(r)):l();return n.parents.push(a),o.push(n),i.push(e),n},a.toJSON=function(){return null!=r&&"function"==typeof r.toJSON?r.toJSON():r},a["fantasy-land/map"]=a.map,a["fantasy-land/ap"]=function(e){return n(function(e,t){return e()(t())},[e,a])},a.unregisterChild=function(e){var t=o.indexOf(e);-1!==t&&(o.splice(t,1),i.splice(t,1))},Object.defineProperty(a,"end",{get:function(){return e||((e=l()).map(function(e){return!0===e&&(a.parents.forEach(function(e){e.unregisterChild(a)}),a.state="ended",a.parents.length=o.length=i.length=0),e}),e)}}),a}function n(n,r){var o=r.every(function(e){if(e.constructor!==l)throw new Error("Ensure that each item passed to stream.combine/stream.merge/lift is a stream");return"active"===e.state}),i=o?l(n.apply(null,r.concat([r]))):l(),a=[],t=r.map(function(t){return t.map(function(e){return a.push(t),(o||r.every(function(e){return"pending"!==e.state}))&&(o=!0,i(n.apply(null,r.concat([a]))),a=[]),e},l.SKIP)}),u=i.end.map(function(e){!0===e&&(t.forEach(function(e){e.end(!0)}),u.end(!0))});return i}function r(e){return n(function(){return e.map(function(e){return e()})},e)}function t(e){return"pending"===e.state||"active"===e.state||"changing"===e.state}Object.defineProperty(l,"HALT",{get:function(){return e||console.log("HALT is deprecated and has been renamed to SKIP"),e=!0,l.SKIP}}),void 0!==o?o.exports=l:"function"!=typeof window.m||"stream"in window.m?window.m={stream:l}:window.m.stream=l}()},{}],29:[function(e,t,n){var r,o,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function l(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{o="function"==typeof clearTimeout?clearTimeout:u}catch(e){o=u}}();var s,c=[],f=!1,d=-1;function p(){f&&s&&(f=!1,s.length?c=s.concat(c):d=-1,c.length&&m())}function m(){if(!f){var e=l(p);f=!0;for(var t=c.length;t;){for(s=c,c=[];++d<t;)s&&s[d].run();d=-1,t=c.length}s=null,f=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===u||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function h(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new v(e,t)),1!==c.length||f||l(m)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],30:[function(l,e,s){(function(e,t){var r=l("process/browser.js").nextTick,n=Function.prototype.apply,o=Array.prototype.slice,i={},a=0;function u(e,t){this._id=e,this._clearFn=t}s.setTimeout=function(){return new u(n.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new u(n.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(e){e.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},s.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},s._unrefActive=s.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},s.setImmediate="function"==typeof e?e:function(e){var t=a++,n=!(arguments.length<2)&&o.call(arguments,1);return i[t]=!0,r(function(){i[t]&&(n?e.apply(null,n):e.call(null),s.clearImmediate(t))}),t},s.clearImmediate="function"==typeof t?t:function(e){delete i[e]}}).call(this,l("timers").setImmediate,l("timers").clearImmediate)},{"process/browser.js":29,timers:30}],31:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var o=r(e("mithril")),i={view:function(){return o.default(".about",o.default("h1","Weboard"),o.default("p","A Web-based MIDI keyboard"))}};n.default=i},{mithril:5}],32:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var o=r(e("mithril")),i=e("../../lib/string"),a={view:function(e){var t=e.attrs.device;return o.default("table.device-details",o.default("thead",o.default("tr",o.default("th",{colspan:2},"MIDI Device"))),o.default("tbody",t?[o.default("tr",o.default("td","ID:"),o.default("td",i.ellipsisTrim(t.id,16))),o.default("tr",o.default("td","Name:"),o.default("td",t.name)),o.default("tr",o.default("td","Manufacturer:"),o.default("td",t.manufacturer)),o.default("tr",o.default("td","Type:"),o.default("td",t.type)),o.default("tr",o.default("td","State:"),o.default("td",t.state))]:[o.default("tr",o.default("td",{colspan:2},"(waiting for MIDI device...)"))]))}};n.default=a},{"../../lib/string":46,mithril:5}],33:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var o=r(e("mithril")),i="keyboard";function a(e){i=e}var u={view:function(e){var t=e.attrs.onInit;return o.default(".init",o.default("p",o.default("input",{id:"radio-input-keyboard",type:"radio",checked:"keyboard"===i,onclick:function(){a("keyboard")}}),o.default("label",{for:"radio-input-keyboard"},"Computer Keyboard")),o.default("p",o.default("input",{id:"radio-input-midi",type:"radio",checked:"midi"===i,onclick:function(){a("midi")}}),o.default("label",{for:"radio-input-midi"},"MIDI")),o.default("p",o.default("input",{id:"radio-input-socket",type:"radio",checked:"socket"===i,onclick:function(){a("socket")}}),o.default("label",{for:"radio-input-socket"},"WebSocket")),o.default("p",{style:{marginTop:"1em"}},o.default("button",{onclick:function(){t(i)}},"Initialize Audio")))}};n.default=u},{mithril:5}],34:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var o,i,a,u=r(e("mithril")),l=r(e("../../lib/MusicPlayer")),s=r(e("../../lib/Input")),c=r(e("../Keyboard")),f=r(e("./DeviceDetails")),d=r(e("./Init")),p=r(e("../Metronome")),m=10,v=[],h=0,y=.75;function g(e){o||i?console.warn("Already initialized"):(o=l.default(),v=o.instruments.map(function(e,t){return u.default("option",{value:t},"("+t+") "+e.label)}),(i=s.default(e,{onPlay:function(e){o.playNote(h,e.pitch,y*e.velocity/100,m),u.default.redraw()},onStop:function(e){o.stopNote(e.pitch),u.default.redraw()}})).status.map(u.default.redraw),i.device.map(function(e){a=e,u.default.redraw()}))}var b={view:function(){return u.default(".dashboard",o?[u.default("div",u.default("label",{for:"select-instrument"},"Instrument: "),u.default("select",{id:"select-instrument",onclick:function(){},onchange:function(e){var t=e.currentTarget,n=Number(t.value);o.loadInstrument(n).then(function(e){h=e,u.default.redraw()})}},v)," ",u.default("label",{for:"range-volume"},"Volume: "),u.default("input",{id:"range-volume",type:"range",min:0,max:1,step:.01,value:y,onchange:function(e){y=Number(e.currentTarget.value)}})),u.default(f.default,{device:a}),o&&u.default(p.default,{player:o}),u.default("p.small","Status: ",i.status()),u.default(c.default,{pressed:o.playingNotes})]:u.default(d.default,{onInit:g}))}};n.default=b},{"../../lib/Input":42,"../../lib/MusicPlayer":43,"../Keyboard":35,"../Metronome":36,"./DeviceDetails":32,"./Init":33,mithril:5}],35:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var o=r(e("mithril")),i=e("../../lib/array"),a=["w","b","w","b","w","w","b","w","b","w","b","w"],u=24,l=8,s={view:function(e){var t=e.attrs;return o.default(".keyboard",function(e){return o.default(".keys",i.range(l).map(function(n){return i.range(12).map(function(t){return c(t+12*n+u,e.some(function(e){return e.pitch===t+12*n+u}))})}).concat([c(144+u,e.some(function(e){return e.pitch===144+u}))]))}(t.pressed),t.pressed.map(function(e){return o.default(".key",e.pitch)}))}};function c(e,t){var n=a[e%12];return o.default(".key."+("b"===n?"black":"white"),{class:t?"pressed":""})}n.default=s},{"../../lib/array":45,mithril:5}],36:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(n,"__esModule",{value:!0});var s=r(e("mithril")),c=r(e("../../lib/Track")),f=o(e("./validate")),d={bpm:100,duration:150,instrument:1217,volume:75,pitch:60,bars:12};function p(e,t,n,r){if(!r)return"00/00/"+n;var o=(e-1)%t+1,i=Math.floor((e-1)/t)+1;return String(o).padStart(2,"0")+"/"+String(i).padStart(2,"0")+"/"+n}n.default=function(e){var n,t=e.attrs.player,r=d.bpm,o=d.instrument,i=d.bars,a=d.volume,u=d.pitch,l=c.default(t,d);return l.beat$.map(function(e){n&&(n.textContent=p(e,4,i,l.isPlaying()))}),{view:function(){return s.default(".metronome",s.default("div",s.default(".field",s.default("div",s.default("button.track-play",{type:"button",id:"btn-metronome-enabled",class:l.isPlaying()?"playing":"",onclick:function(){l.toggle()}},"METRONOME"))),s.default(".field",s.default("label",{for:"input-metronome-bars"},"Bar ",s.default("span",{style:"font-family: monospace",oncreate:function(e){var t=e.dom;n=t}},p(l.beat$(),4,i,l.isPlaying()))," "),s.default("input.input-bpm",{id:"input-metronome-bars",type:"text",value:i,oninput:function(e){i=f.bars(e.currentTarget.value,i)}})),s.default(".field",s.default("label",{for:"input-metronome-bpm"},"BPM: "),s.default("input.input-bpm",{id:"input-metronome-bpm",type:"text",value:r,oninput:function(e){r=f.bpm(e.currentTarget.value,r),l.set({bpm:r})}})),s.default(".field",s.default("label",{for:"input-metronome-inst"},"Inst: "),s.default("input.input-instrument",{id:"input-metronome-inst",type:"text",value:o,oninput:function(e){var t=f.instrument(e.currentTarget.value,o);null!=t&&t!==o&&l.setInstrument(t).then(function(){o=t,s.default.redraw()})}})),s.default(".field",s.default("label",{for:"input-metronome-volume"},"Vol: "),s.default("input.input-bpm",{id:"input-metronome-volume",type:"text",value:a,oninput:function(e){a=f.volume(e.currentTarget.value,r),l.set({volume:a})}})),s.default(".field",s.default("label",{for:"input-metronome-pitch"},"Pitch: "),s.default("input.input-bpm",{id:"input-metronome-pitch",type:"text",value:u,oninput:function(e){u=f.pitch(e.currentTarget.value,u),l.set({pitch:u})}}))))}}}},{"../../lib/Track":44,"./validate":37,mithril:5}],37:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.bpm=function(e,t){var n=Number(e);return Number.isSafeInteger(n)&&0<=n&&n<1e3?n:t},n.bars=function(e,t){var n=Number(e);return Number.isSafeInteger(n)&&0<=n&&n<100?n:t},n.instrument=function(e,t){var n=Number(e);return Number.isSafeInteger(n)&&0<=n&&n<1394?n:t},n.volume=function(e,t){var n=Number(e);return Number.isSafeInteger(n)&&0<=n&&n<=100?n:t},n.pitch=function(e,t){var n=Number(e);return Number.isSafeInteger(n)&&0<=n&&n<128?n:t}},{}],38:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var o=r(e("mithril")),i=r(e("./components/Dashboard")),a=r(e("./components/About"));o.default.route(document.body,"/",{"/":i.default,"/about":a.default})},{"./components/About":31,"./components/Dashboard":34,mithril:5}],39:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var o,a=r(e("mithril/stream")),u=e("../array"),l=r(e("./index"));function s(n){var e=a.default(),t=a.default(),r=u.range(l.default.TOTAL_NOTES).map(function(e){return!1});function o(e){var t=s.keyCodeToPitch(e.keyCode);r[t]||(r[t]=!0,n.onPlay(new l.default.PlayEvent("play",t,l.default.MAX_VELOCITY)))}function i(e){var t=s.keyCodeToPitch(e.keyCode);r[t]=!1,n.onStop(new l.default.PlayEvent("play",t,l.default.MAX_VELOCITY))}return window.addEventListener("keydown",o),window.addEventListener("keyup",i),Promise.resolve().then(function(){e("Keyboard connected"),t({id:"0",name:"Computer keyboard",manufacturer:"unknown",state:"connected",type:"computer"})}),{status:e,device:t,state:r,destroy:function(){window.removeEventListener("keydown",o),window.removeEventListener("keyup",i)}}}(o=s=s||{}).keyCodeToPitch=function(e){return e},o.pitchToKeyCode=function(e){return e},n.default=s},{"../array":45,"./index":42,"mithril/stream":27}],40:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var s=r(e("mithril/stream")),c=e("../array"),f=r(e("."));n.default=function(i){var n=s.default(),r=s.default(),a=c.createFill(!1,f.default.TOTAL_NOTES),o=[];function u(e){console.log("midiOnStateChange event:",e);var t=e.port;console.log("port:",e.port),n(t.manufacturer+" / "+t.name+" ("+t.state+")"),r({id:t.id,name:t.name,manufacturer:t.manufacturer,state:t.state,type:t.type})}function l(e){var t=e.data,n=(t[0],t[0],240&t[0]),r=t[1],o=t[2];switch(n){case 144:0<o?(a[r]=!0,i.onPlay(new f.default.PlayEvent("play",r,o))):(a[r]=!1,i.onStop(new f.default.PlayEvent("stop",r,o)));break;case 128:a[r]=!1,i.onStop(new f.default.PlayEvent("stop",r,o))}}return navigator.requestMIDIAccess?(console.log("navigator.requestMIDIAccess found"),navigator.requestMIDIAccess().then(function(e){for(var t=e.inputs.values(),n=t.next();n&&!n.done;n=t.next()){var r=n.value;console.log("midi input:",r),o.push(r),r.addEventListener("midimessage",l)}e.onstatechange=u}).catch(function(e){console.log("requestMIDIAccessFailure:",e),n("MIDI access request failed.")})):(console.log("navigator.requestMIDIAccess undefined"),n("MIDIAccess unsupported")),{status:n,device:r,state:a,destroy:function(){for(var e=0,t=o;e<t.length;e++){t[e].removeEventListener("midimessage",l)}}}}},{".":42,"../array":45,"mithril/stream":27}],41:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=r(e("mithril/stream")),u=e("../array"),l=r(e(".")),s=3030;n.default=function(n){var t=a.default(),r=a.default(),o=u.createFill(!1,l.default.TOTAL_NOTES),i={type:0,pitch:0,velocity:0},e=new WebSocket("ws://localhost:"+s);return e.addEventListener("message",function(e){var t=String(e.data).split(" ");switch(i.type=Number(t[0]),i.pitch=Number(t[1]),i.velocity=Number(t[2]),i.type){case 144:0<i.velocity?(o[i.pitch]=!0,n.onPlay(new l.default.PlayEvent("play",i.pitch,i.velocity))):(o[i.pitch]=!1,n.onStop(new l.default.PlayEvent("stop",i.pitch,i.velocity)));break;case 128:o[i.pitch]=!1,n.onStop(new l.default.PlayEvent("stop",i.pitch,i.velocity))}}),e.addEventListener("open",function(e){t("WebSocket connected"),r({id:"??",name:"WebSocket",manufacturer:"",state:"open",type:"WebSocket"})}),{status:t,device:r,state:o,destroy:function(){null!=e&&(e.close(),e=void 0)}}}},{".":42,"../array":45,"mithril/stream":27}],42:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var o=r(e("./MidiInput")),i=r(e("./KeyboardInput")),a=r(e("./SocketInput"));function u(e,t){return"midi"===e?o.default(t):"socket"===e?a.default(t):i.default(t)}!function(e){e.TOTAL_NOTES=128,e.MAX_VELOCITY=127;function t(e,t,n){void 0===n&&(n=0),this.type=e,this.pitch=t,this.velocity=n}e.PlayEvent=t;function n(e,t){this.type=e,this.device=t}e.DeviceEvent=n}(u=u||{}),n.default=u},{"./KeyboardInput":39,"./MidiInput":40,"./SocketInput":41}],43:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=AudioContext||window.webkitAudioContext;n.default=function(){if(!r)throw new Error("Could not find AudioContext support");if(!window._tone_0000_JCLive_sf2_file)throw new Error("_tone_0000_JCLive_sf2_file object not found on window");var a=[],u=new r,l=new window.WebAudioFontPlayer;l.loader.decodeAfterLoading(u,"_tone_0000_JCLive_sf2_file");var s=l.loader.instrumentKeys().map(function(e,t){return{key:e,label:l.loader.instrumentInfo(t).title,tone:void 0}});function c(e){for(var t=0;t<a.length;++t){var n=a[t];if(n.pitch===e)return n.envelope&&n.envelope.cancel(),void a.splice(t,1)}}return s[0].tone=window._tone_0000_JCLive_sf2_file,{playNote:function(e,t,n,r){if(c(t),"number"!=typeof e||!Number.isSafeInteger(e)||e<0||e>=s.length)throw new Error("Invalid instrument index: "+e);var o=s[e];if(!o.tone)return console.warn("This tone hasn't been loaded yet"),!1;var i={pitch:t,envelope:l.queueWaveTable(u,u.destination,o.tone,0,t,r,n)};return a.push(i),!0},stopNote:c,instruments:s,loadInstrument:function(r){return!Number.isSafeInteger(r)||r<0||r>=s.length?Promise.reject(new Error("Out of range instrument index: "+r)):null!=s[r].tone?Promise.resolve(r):new Promise(function(t,e){var n=l.loader.instrumentInfo(r);l.loader.startLoad(u,n.url,n.variable),l.loader.waitLoad(function(){var e=window[n.variable];s[r].tone=e,console.log("loaded instrument '"+n.variable+"' ("+r+"). tone:",e),l.cancelQueue(u),t(r)})})},playingNotes:a}}},{}],44:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var p=r(e("mithril/stream"));n.default=function(t,e){var n,r=e.bpm,o=e.duration,i=e.instrument,a=e.pitch,u=e.volume,l=!1,s=0,c=p.default(0);function f(e){return t.loadInstrument(e).then(function(){s=e}).catch(function(e){console.warn(e.message)})}function d(){null!=n&&(clearTimeout(n),n=void 0),l&&(t.playNote(s,a,u,o/1e3),setTimeout(function(){t.stopNote(a)},o),n=setTimeout(d,6e4/r),Promise.resolve().then(function(){c(c()+1)}))}return f(i),{toggle:function(){return l=!l,c(0),l?d():(clearTimeout(n),n=void 0),l},stop:function(){l&&(null!=n&&(clearTimeout(n),n=void 0),c(0))},set:function(e){return null!=e.bpm&&(r=e.bpm),null!=e.pitch&&(a=e.pitch),null!=e.volume&&(u=e.volume),null!=e.instrument?f(e.instrument):Promise.resolve()},getInstrument:function(){return null!=s?s:i},setInstrument:f,beat$:c,isPlaying:function(){return l}}}},{"mithril/stream":27}],45:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createFill=function(e,t){for(var n=[],r=0;r<t;++r)n.push(e);return n},n.range=function(e,t,n){n=n||1,null==t&&(t=e,e=0);for(var r=Math.ceil((t-e)/n),o=[],i=0;i<r;++i)o.push(e+n*i);return o}},{}],46:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ellipsisTrim=function(e,t){return!t||t<2||e.length<=t?e:e.substr(0,t-1)+"…"}},{}]},{},[38]);